ASP (Active Server Page)與 WEB 資料庫 平台
軟體須求 NT 4.0 ：sp3、IE4.01以上、IIS 4.0
Win 95/98 ：IE4.01以上、PWS 4.0
 
必備知識 HTML、VB Script 
ASP 物件(全域變數) Server 可提供 Server 的相關資訊
Application 可用來紀錄不同網頁的共同資訊
Session 可用來記錄連線者的資訊
Request 用來讀取瀏覽器的資訊
Response 可用來傳輸資料到瀏覽器
ObjectContext 提供交易的功能 
WEB 資料庫 ODBC 驅動程式 (Open DataBase Connectivity)
ADO 物件 (ActiveX Data Object)
SQL 結構化查詢語言(Structured Query Language) 
ADO (ActiveX Data Object) 物件 Connection 物件
Recordset 物件
Command 物件 
Connection 物件 Set conn= Server.CreateObject(“ADODB.Connection”) 建立連線  
　 Conn.Open “driver={Microsoft Access Driver (*.mdb)};dbq=” & Server.Mapth(“advworks.mdb”) 利用 ODBC 開啟 mdb資料庫 
　 conn.Open "Provider=Microsoft.jet.OLEDB.4.0;Data Source=" & Server.Mapth(“advworks.mdb”) 利用 OLEDB 開啟 mdb資料庫 
　 conn.Open "driver={SQL server};server=fuin;database=accttable;uid=super;pwd=dr;"  利用 ODBC 開啟 SQL 資料庫 
　 conn.Open "Provider=SQLOLEDB.1;Data Source=fuin;User ID=super;Passwd=dr;Initial Catalog=accttable;" 利用 OLEDB 開啟 SQL資料庫 
　 Conn.open “DSN=advworks” 利用DSN(Data Sorece Name)開啟 mdb 資料庫 
　 conn.BeginTrans 交易開始 
　 conn.RollbackTrans 取消交易 
　 conn.CommitTrans 交易結束 
Recordset 物件 Set rs = conn.Execute (“Customers”)  以資料表建立 Rs 物件(唯讀) 
　 Set rs = conn.Execute(“select * from customers”) 以SQL 建立 Rs 物件(唯讀) 
　 Set rs = Sever.CreateObject(“ADODB.Recordset”)
Rs.open sql,conn,adOpenStatic,adLockPessimistic
參數三 adOpenForwardOnly 是 Connection 物件
參數四 adLockReadOnly 是 Recordset 鎖定類型
adOpenForwardOnly :
(=0) 唯讀、只能下移
(=3) 唯讀、可自由移動
(=1) 可讀寫、可自由移動
(=2) 可讀寫、可自由移動 
adLockReadOnly :
(=1) 預設值、唯讀
(=2) 悲觀鎖定
(=3) 樂觀鎖定
(=4) 批次樂觀鎖定 
　 rs(0).name 讀取抬頭 
　 rs(0) 讀取第一欄內容 
　 rs("學號") 讀取學號欄內容 
　 rs.Fields.count 讀取欄位數目 
　 rs.Movenext 移至下一筆 
　 rs.MovePrevious 移至上一筆 
　 rs.MoveFirst 移至第一筆 
　 rs.MoveLast 移至最後一筆 
　 rs.Eof 是否為最後一筆 
　 rs.Bof 是否為第一筆 
　 rs.AbsolutePosition = N 移至第N筆 
　 rs.AbsolutePage = N  移至第N頁 
　 rs.PageSize=N 設定每頁的資料錄數 
　 rs.PageCount 總頁數 
　 rs.Delete 刪除該資料錄 
　 rs.Update
rs.Update 欄名陣,欄值陣列 更新該資料錄(二段式)
更新該資料錄(直接) 
　 rs.CancelUpdate 取消更新該資料錄 
　 rs.AddNew
rs.AddNew 欄名陣,欄值陣列 新增一筆(二段式)
新增一筆(直接) 
Command 物件 Set cmd = Server.CreateObject(“ADODB.command”) 建立 Command 物件 
　 Set cmd.ActiveConnection = conn 屬性ActiveConnection 指向 conn 
　 cmd.CommandText = SQL 屬性CommandText 指向 SQL 
　 set rs.cmd.Execute
Set rs= cmd.execute(,param) 產生 rs物件
帶有參數的查詢物件 
FileSystemObject物件 set fso=server.createobject("Scripting.fileSystemObject") 建立FileSystemObject物件 
　 fso.FileExists( filepath) 檔案是否存在 
　 fso.movefile Oldfilepath,Newfilepath 檔案更名 
　 fso.DeleteFile OldFilePath,true 檔案刪除 
　 fso.Copyfile Source,Dest,true 檔案複製 
File物件 set f=fso.OpenTextFile(FilePath[,mode[,make]) 開啟 File物件 mode=1是唯讀 2 是唯寫 8 是可讀寫,make=true是自動建立 
　 set f=fso.CreateTextFile(FilePath[,mode]) 建立 File物件 mode =true 時可覆寫,mode=false須不存在才可 
　 s= f.ReadLine 讀取一行 
　 f.WriteLine s 將 s 寫入,會在資訊後加vbCrLf 
　 f.Write s 將 s 寫入 
　 s=f.Read(N) 讀取N個位元組 
　 s=f.ReadAll 讀取所有內容 
　 f.close 關閉檔案 
　 f.atendOfstream  測試是否到檔案結尾 
Err物件 Err.number = 53 找不到檔案 
　 Err.number = 70 檔案被鎖定 
　 Err.number = 62 輸入超出檔案結尾 
　 　 　 
Response物件 response.redirect  "a.asp" 網址 : 轉移網頁  
　 response.end 結束網頁 
　 response.write  資料  回給瀏覽器 
　 response.buffer =true 設定為緩衝區方式 
　 response.clear 清除緩衝區資料 
　 response.flush 輸出緩衝區資料 
　 response.IsConnected 檢查否連線中 
server物件 path=server.mappath("test.mdb") 傳回網址實施路徑 
　 server.HTMLEncode 資料 html編碼 
　 server.URLEncode 資料 URL 編碼 
　 　 　 
cookie response.cookies("cookie名稱") ="cookie的內容" 寫入Cookie內容
 
　 request.cookies("cookie名稱") 讀取Cookie 內容(無資料時是傳回空字串,空字串不可做+-等運算) 
　 request.cookies.count 讀取 Cookie 的數目 
　 request.cookies(1)  取第一個 cookie物件的內容 
　 response.cookies("name").expires=dateadd("d",N,date) 設定期限 
　 response.cookies("dic")("Learn")="VB教本" :  設定 cookies 
　 response.cookies("name").domain="www.kj.com" : 設定Cookie 所屬的Webserver 
　 response.cookies("name").path="/source" 設定cookie所屬的路徑 
resquest物件 path=request.servervariables("path_info") 傳回網頁的虛擬路徑檔案名稱 
　 domain=request.servervariables("SERVER_NAME") 傳回網頁的Domain 之環境變數 
　 serverip=request.servervariables("Local_ADDR" 讀取Server端IP 
　 serverip=request.servervariables("REMOTE_ADDR" 讀取客戶端IP 
　 param=request.servervariables("QUERY_STRING") 讀取附帶之參數,亦可以 param=request.QueryString 代 
Application物件 Application("變數名稱")=變數值 寫入變數 
　 變數=Application("變數名稱") 讀取變數內容(無資料時是傳回empty) 
　 set 物件名稱=Application("物件名稱") 寫入物件 
　 Application.lock 鎖定Application物件 
　 Application.unlock 解除Application物件鎖定 
include <!-- #include file="a.asp" -->
<!-- #include virtual="/ols/a.asp" a.asp須位於ASP程式所在
a.asp須位於虛擬目錄中 
Session 物件 Session ("變數名稱")=變數值 寫入變數 
　 session.timeout=n 設定斷線時間 
AdRotator物件 Set Ad=server.createObject("MSWC.AdRotator") 建立AdRotator物件 
　 Ad.GetAvertisememt("Adrot.txt") 讀取檔案將廣告旋板顯示 
